@page "/note-editor"
@inject ISender Sender

<PageTitle>Create Note</PageTitle>
<h3>Create Note</h3>
<EditForm Model="Note" OnSubmit="HandleSubmit" FormName="NoteEditorForm">
    <InputText @bind-Value="Note!.Title" placeholder="Title" class="form-control mb-2" />
    <InputTextArea @bind-Value="Note.Content" placeholder="Content" class="form-control mb-2" rows="5" />
    <label>Select a published date</label>
    <InputDate @bind-Value="Note.PublishedAt" class="form-control mb-2" />
    <div class="form-check">
        <InputCheckbox @bind-Value="Note.IsPublished" class="form-check-input mb-2" />
        <label class="form-check-label mb-2">Is Published</label>
    </div>
    <button type="submit" class="btn btn-primary mt-3 w-100">Create Note</button>
</EditForm>


@code {
    [SupplyParameterFromForm]
    private NoteModel? Note { get; set; }
    protected override void OnInitialized() => Note ??= new NoteModel();
    private async Task HandleSubmit()
    {
        var command = Note.Adapt<CreateNoteCommand>();
        var result = await Sender.Send(command);

        Note = result.Adapt<NoteModel>();
        Console.WriteLine("Note created with ID: " + Note.Id);
    }
}